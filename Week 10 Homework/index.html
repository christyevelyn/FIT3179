<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
</head>
<body>
  <div id="vis"/>
  <script>
    const spec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/6_advanced_examples/data/earthquake_lite.csv"
  },
  "title": "Diabetes Cases in Australia",
  "vconcat": [
    { 
    "width": 500,
    "height": 500,
    "title": "Diabetes Cases by States",
    "projection": {"type": "mercator"},
    "data": {
    "url": "https://raw.githubusercontent.com/christyevelyn/FIT3179/main/STE_2016_AUST-2.json",
    "format": {"type": "topojson", "feature": "STE_2016_AUST"}
    },
    "transform": [
    {
        "lookup": "properties.STE_NAME16",
        "from": {
        "data": {
            "url": "https://raw.githubusercontent.com/christyevelyn/FIT3179/main/au_health.csv"
        },
        "key": "StateFull",
        "fields": ["Diabetes mellitus(f)"]
        }
    }
    ],
    "mark": "geoshape",
    "encoding": {
    "color": {
        "field": "Diabetes mellitus(f)",
        "type": "quantitative",
        "title": "Estimated cases ('000)"
    },
    "tooltip": [
        {"field": "properties.STE_NAME16", "title": "State"},
        {
        "field": "Diabetes mellitus(f)",
        "type": "quantitative",
        "title": "Estimated cases ('000)"
        }
    ]
    }
},
{
    "width": 750,
    "height": 400,
    "title": "Diabetes Cases by Age and Sex",
    "data": {
    "url": "https://raw.githubusercontent.com/christyevelyn/FIT3179/f8815a1ed74b497f3525a8ea033405d8ea074ff7/AIHW-CVD-96-Diabetes-facts-data-tables-12122024.csv",
    "format": {"type": "csv"}
    },
    "transform": [
    {
        "calculate": "toNumber(replace(datum.Cases, /[, ]/g, ''))",
        "as": "CasesNum"
    }
    ],
    "layer": [
    {
        "mark": "bar",
        "encoding": {
        "x": {
            "field": "Age group",
            "type": "ordinal",
            "title": "Age Group",
            "sort": [
            "0-4",
            "5-9",
            "10-14",
            "15-19",
            "20-24",
            "25-29",
            "30-34",
            "35-39",
            "40-44",
            "45-49",
            "50-54",
            "55-59",
            "60-64",
            "65-69",
            "70-74",
            "75-79",
            "80-84",
            "More than 85"
            ]
        },
        "y": {
            "field": "Cases",
            "type": "quantitative",
            "title": "Number of Cases"
        },
        "color": {
            "field": "Sex",
            "type": "nominal",
            "title": "Sex",
            "scale": {"range": ["#4575b4", "#d73027"]},
            "sort": ["Males", "Females"]
        },
        "xOffset": {"field": "Sex", "sort": ["Males", "Females"]},
        "tooltip": [
            {"field": "Age group", "title": "Age Group"},
            {"field": "Sex", "title": "Sex"},
            {
            "field": "Cases",
            "type": "quantitative",
            "title": "Number of cases"
            }
        ]
        }
    },
    {
        "mark": {
        "type": "text",
        "align": "center",
        "baseline": "bottom",
        "dy": -4,
        "fontSize": 7,
        "color": "black",
        "strokeWidth": 1
        },
        "encoding": {
        "x": {"field": "Age group"},
        "y": {"field": "CasesNum", "type": "quantitative"},
        "xOffset": {"field": "Sex", "sort": ["Males", "Females"]},
        "text": {"field": "CasesNum", "type": "quantitative"}
        }
    }
    ]
    }
    ],
  "config": {"title": {"font": "sans-serif", "fontSize": 16}}
};
    vegaEmbed("#vis", spec, {mode: "vega-lite"}).then(console.log).catch(console.warn);
  </script>
</body>
</html>